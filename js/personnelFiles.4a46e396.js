(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["personnelFiles"],{"15d1":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container",attrs:{id:"personnelFiles"}},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",attrs:{placeholder:"姓名/身份证号码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}}),i("el-button",{staticClass:"filter-item filter-item-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),i("el-button",{staticClass:"filter-item filter-item-btn",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.handleCreate}},[e._v("添加")]),i("el-button",{staticClass:"filter-item filter-item-btn",attrs:{type:"primary",icon:"iconfont icondaochu",loading:e.exportLoading},on:{click:e.exportExcel}},[e._v("导出")]),i("el-button",{staticClass:"filter-item filter-item-btn",attrs:{type:"primary",icon:"iconfont icondaoru"},on:{click:function(t){e.uploadVisible=!0}}},[e._v("导入")])],1),i("div",{staticClass:"tableBox"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,fit:"","highlight-current-row":"","row-class-name":e.tableRowClassName}},[i("el-table-column",{attrs:{label:"序号",fixed:"",prop:"id",sortable:"custom",align:"center",width:"80",type:"index",index:e.indexMethod}}),i("el-table-column",{attrs:{label:"姓名",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.handleUpdate(a)}}},[e._v(e._s(a.name))])]}}])}),i("el-table-column",{attrs:{label:"绑定标签",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.rfid))])]}}])}),i("el-table-column",{attrs:{label:"状态",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.formatStatus(t.row.status)))])]}}])}),i("el-table-column",{attrs:{label:"职位",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.formatPostStatus(t.row.workTypes)))])]}}])}),i("el-table-column",{attrs:{label:"车组名称","min-width":"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.groupName))])]}}])}),i("el-table-column",{attrs:{label:"身份证号",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.userCode))])]}}])}),i("el-table-column",{attrs:{label:"性别",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.formatSexStatus(t.row.sex)))])]}}])}),i("el-table-column",{attrs:{label:"年龄",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.age>-1?t.row.age:""))])]}}])}),i("el-table-column",{attrs:{label:"电话号码",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.telNum))])]}}])}),i("el-table-column",{attrs:{label:"地址","min-width":"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.address))])]}}])}),i("el-table-column",{attrs:{label:"入职时间",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.officeTimeShow))])]}}])}),i("el-table-column",{attrs:{label:"头像","min-width":"80px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.photoId?i("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.popShow(a)}}},[e._v("点击显示")]):i("span",{staticStyle:{color:"red"}},[e._v("暂无照片")])]}}])}),i("el-table-column",{attrs:{label:"操作",align:"center","min-width":"400",fixed:"right","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[null==a.rfidId?i("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont iconsuo"},on:{click:function(t){return e.handleBind(a)}}},[e._v("绑定标签")]):i("el-button",{attrs:{type:"warning",size:"mini",icon:"iconfont iconjiesuo5"},on:{click:function(t){return e.handleUnbind(a)}}},[e._v("解绑标签")]),i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit-outline"},on:{click:function(t){return e.handleUpdate(a)}}},[e._v("编辑")]),i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.deleteConfirmOpen(a)}}},[e._v("删除")]),i("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont iconshangchuan"},on:{click:function(t){return e.handleUpload(a)}}},[e._v("上传")])]}}])})],1)],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit,layout:"prev, pager, next, sizes, total, jumper"},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}}),i("el-dialog",{attrs:{id:"myDialog",title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,center:""},on:{close:e.scrollTop,"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:"dataForm",staticClass:"formStyle",attrs:{rules:e.rules,model:e.temp,"label-position":"left"}},["create"==e.dialogStatus?i("el-form-item",{attrs:{label:"姓名",prop:"name"}},[i("el-input",{model:{value:e.temp.name,callback:function(t){e.$set(e.temp,"name",t)},expression:"temp.name"}})],1):e._e(),i("el-form-item",{attrs:{label:"身份证号",prop:"userCode"}},[i("el-input",{model:{value:e.temp.userCode,callback:function(t){e.$set(e.temp,"userCode",t)},expression:"temp.userCode"}})],1),i("el-form-item",{attrs:{label:"性别",prop:"sex"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.temp.sex,callback:function(t){e.$set(e.temp,"sex",e._n(t))},expression:"temp.sex"}},e._l(e.sexOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}),1)],1),i("el-form-item",{attrs:{label:"年龄",prop:"age"}},[i("el-input",{model:{value:e.temp.age,callback:function(t){e.$set(e.temp,"age",e._n(t))},expression:"temp.age"}})],1),i("el-form-item",{attrs:{label:"电话号码",prop:"telNum"}},[i("el-input",{model:{value:e.temp.telNum,callback:function(t){e.$set(e.temp,"telNum",t)},expression:"temp.telNum"}})],1),i("el-form-item",{attrs:{label:"地址",prop:"address"}},[i("el-input",{model:{value:e.temp.address,callback:function(t){e.$set(e.temp,"address",t)},expression:"temp.address"}})],1),i("el-form-item",{attrs:{label:"入职时间",prop:"officeTimeShow"}},[i("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",align:"right",type:"datetime",placeholder:"选择日期","picker-options":e.pickerOptions},model:{value:e.temp.officeTimeShow,callback:function(t){e.$set(e.temp,"officeTimeShow",t)},expression:"temp.officeTimeShow"}})],1),"update"==e.dialogStatus&&1==e.power?i("el-form-item",{attrs:{label:"所属大队",prop:"teamId"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.temp.teamId,callback:function(t){e.$set(e.temp,"teamId",e._n(t))},expression:"temp.teamId"}},e._l(e.largeTeamOptions,function(e){return i("el-option",{key:e.id,attrs:{label:e.teamName,value:e.id}})}),1)],1):e._e(),i("el-form-item",{attrs:{label:"状态",prop:"status"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.temp.status,callback:function(t){e.$set(e.temp,"status",e._n(t))},expression:"temp.status"}},e._l(e.personStatusOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}),1)],1),i("el-form-item",{attrs:{label:"职位",prop:"workTypes"}},[i("el-select",{staticClass:"filter-item",attrs:{multiple:"",placeholder:"Please select"},model:{value:e.temp.workTypes,callback:function(t){e.$set(e.temp,"workTypes",t)},expression:"temp.workTypes"}},e._l(e.postOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}),1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v("确定")])],1)],1),i("el-dialog",{attrs:{id:"myDialog",title:e.bindMap[e.bindDialogStatus],visible:e.BindDialogFormVisible,center:""},on:{close:e.scrollTop,"update:visible":function(t){e.BindDialogFormVisible=t}}},[i("el-form",{ref:"bindForm",staticClass:"bindForm formStyle",attrs:{rules:e.bindRules,"label-position":"left",model:e.bindTemp}},[i("el-form-item",{attrs:{label:e.bindMap[e.bindDialogStatus]+"类型",prop:"type"}},[i("el-select",{staticClass:"filter-item",attrs:{filterable:"",placeholder:"Please select"},model:{value:e.bindTemp.type,callback:function(t){e.$set(e.bindTemp,"type",t)},expression:"bindTemp.type"}},e._l(e.bindTypeOptions,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id,disabled:e.disabled}})}),1)],1),1==e.bindTemp.type&&"bind"==e.bindDialogStatus?i("el-form-item",{attrs:{label:"所属大队",prop:"teamId"}},[i("el-select",{staticClass:"filter-item",attrs:{filterable:"",placeholder:"Please select"},model:{value:e.bindTemp.teamId,callback:function(t){e.$set(e.bindTemp,"teamId",t)},expression:"bindTemp.teamId "}},e._l(e.largeTeamOptions,function(e){return i("el-option",{key:e.id,attrs:{label:e.teamName,value:e.id}})}),1)],1):e._e(),2==e.bindTemp.type&&"bind"==e.bindDialogStatus?i("el-form-item",{attrs:{label:"标签",prop:"rfidId"}},[i("el-select",{staticClass:"filter-item",attrs:{filterable:"",placeholder:"Please select"},model:{value:e.bindTemp.rfidId,callback:function(t){e.$set(e.bindTemp,"rfidId",t)},expression:"bindTemp.rfidId "}},e._l(e.rfidOptions,function(e){return i("el-option",{key:e.id,attrs:{label:e.rfid,value:e.id}})}),1)],1):e._e()],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){"bind"==e.bindDialogStatus?e.bindSubmit():e.unbindSubmit()}}},[e._v("确定")])],1)],1),i("el-dialog",{attrs:{id:"myDialog1",title:"上传图片",visible:e.DialogUploadVisible,center:""},on:{"update:visible":function(t){e.DialogUploadVisible=t}}},[i("el-upload",{ref:"my-upload",staticClass:"upload-demo",attrs:{multiple:!1,limit:1,drag:"",action:"/gate/file/xxx/upload",accept:".jpg,.png","before-upload":e.beforeUploadFile,headers:{Authorization:"Bearer "+e.token},"on-success":e.uploadSuccess}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击上传")])]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件,且文件大小不得超过10M")]),i("div",{staticClass:"el-upload__tip red",attrs:{slot:"tip"},slot:"tip"},[e._v("图片上传尺寸请尽量为 295*413 ")])]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1),i("el-dialog",{attrs:{id:"myDialog2",width:"30%",title:"图片",visible:e.imgVisible,center:""},on:{"update:visible":function(t){e.imgVisible=t}}},[i("img",{staticClass:"taskSrc",attrs:{src:e.taskSrc,alt:"暂无图片"}})]),i("my-upload",{attrs:{visible:e.uploadVisible,uploadData:{type:1}},on:{"update:visible":function(t){e.uploadVisible=t},dataUpdated:e.reqSuccess}})],1)},n=[],s=(i("34ef"),i("7514"),i("ac6a"),i("5df3"),i("cebc")),l=(i("57e7"),i("9865"),i("7f7f"),i("78ce"),i("333d")),o=i("98c6"),r=i("47a3"),c=i("d256"),d=i("66e8"),u=i("4807"),p=[{key:1,display_name:"男"},{key:0,display_name:"女"}],m=[{key:0,display_name:"在职"},{key:1,display_name:"离职"},{key:2,display_name:"请假"}],f=[{key:1,display_name:"司机"},{key:2,display_name:"车组长"},{key:3,display_name:"押运员"},{key:4,display_name:"业务员"},{key:5,display_name:"大队长"},{key:6,display_name:"枪管员"},{key:7,display_name:"车管员"},{key:8,display_name:"库管员"}],g=function(e,t,i){-1==t?i(new Error("请选择")):i()},b=function(e,t,i){t||i(),setTimeout(function(){/^1[3456789]\d{9}$/.test(t)?i():i(new Error("手机号码有误，请重填"))},1e3)},h=void 0,y={name:"ComplexTable",components:{Pagination:l["a"],myUpload:o["a"]},data:function(){return{power:JSON.parse(sessionStorage.getItem("userInfo")).Power,token:JSON.parse(sessionStorage.getItem("userInfo"))["Bearer "],tableKey:0,list:null,total:0,indexMethod:1,listLoading:!1,listQuery:{page:1,limit:10,name:""},sexOptions:p,largeTeamOptions:[{id:-1,teamName:"请选择"}],personStatusOptions:m,postOptions:f,groupOptions:[{id:null,groupName:"请选择"}],groupOptionsAll:[{id:null,groupName:"请选择"}],groupOptionsPart:[{id:null,groupName:"请选择"}],gunOptions:[{id:null,iMei:"请选择"}],temp:{name:null,userCode:"",sex:1,age:"",officeTime:null,status:0,workTypes:[]},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"添加"},rules:{name:[{required:!0,message:"请填写姓名",trigger:"blur"}],userCode:[{required:!0,message:"请填写身份证号",trigger:"blur"}],sex:[{required:!0,type:"number",message:"请选择性别",trigger:"change"}],workTypes:[{required:!0,message:"请选择职位",trigger:"change"}],telNum:[{validator:b,trigger:"blur"}]},pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},bindTypeOptions:[{id:-1,name:"请选择"},{id:2,name:"标签"}],bindTemp:{},BindDialogFormVisible:!1,bindDialogStatus:"",bindMap:{bind:"绑定",unbind:"解绑"},bindRules:{type:[{required:!0,message:"请选择绑定类型",trigger:"change",validator:g}],teamId:[{required:!0,message:"请选择绑定大队",trigger:"change",validator:g}],rfidId:[{required:!0,message:"请选择绑定标签",trigger:"change"}],scanDeviceId:[{required:!0,message:"请选择扫描设备",trigger:"change",validator:g}]},rfidOptions:[],scanOptions:[],fileList:[],DialogUploadVisible:!1,personId:null,imgVisible:!1,taskSrc:"",initialWorkTypes:[],uploadVisible:!1,exportLoading:!1}},created:function(){this.getList(),this.getSelect()},methods:{deleteConfirmOpen:function(e){var t=this;this.$confirm("确定进行此操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){t.$message({type:"info",message:"已取消"})})},beforeUploadFile:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),i=e.size/1024/1024;return"jpg"!==t&&"png"!==t&&"JPG"!==t&&"PNG"!==t?(this.$message.warning("只能上传后缀是.jpg或者.png的文件"),!1):i>10?(this.$message.warning("文件大小不得超过10M"),!1):void 0},reqSuccess:function(e){1==e&&this.getList()},popShow:function(e){var t=this;this.listLoading=!0,this.taskSrc="";var i=this;if(null==e.photoId)return this.imgVisible=!0,void(this.listLoading=!1);Object(c["q"])({id:e.photoId,type:[1]}).then(function(e){if(0==e.status){if(e.data&&0==e.data.length)return void(i.imgVisible=!0);Object(c["m"])({path:e.data[0].path,fileName:e.data[0].fileName}).then(function(e){i.imgVisible=!0,i.listLoading=!1,i.taskSrc=window.URL.createObjectURL(e)}).finally(function(){i.listLoading=!1})}else t.$message.error(e.msg)}).catch(function(){i.listLoading=!1}).finally(function(){})},handleUpload:function(e){var t=this;this.DialogUploadVisible=!0,this.$nextTick(function(){t.$refs["my-upload"].clearFiles()}),this.personId=e.id},uploadSuccess:function(e){var t=this;if(null!=e.data){var i=new Promise(function(t,i){Object(c["G"])({fileName:e.data.filename,path:e.data.path,type:1,status:1}).then(function(e){t(e)}).catch(function(e){i(e)})});i.then(function(e){Object(c["g"])({personId:t.personId,photoId:e.data}).then(function(e){0==e.status?(t.DialogUploadVisible=!1,t.$message.success(e.msg),t.getList()):t.$message.error(e.msg)}).catch(function(){t.$message.error(res1.msg)}).finally(function(){_t.listLoading=!1})},function(e){_t.listLoading=!1,t.$message.error(e.msg)})}},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},handleBind:function(e){for(var t=null,i=[],a=0;a<e.workTypes.length;a++){var n=e.workTypes[a];switch(n){case 1:t=10;break;case 2:t=10;break;case 3:t=10;break;case 4:t=10;break;case 5:t=10;break;case 6:t=6;break;case 7:t=7;break;case 8:t=8;break;case 9:t=9;break;case 10:t=10;break;case 80:t=80;break;case 90:t=90;break;case 99:t=99;break}null!==t&&-1==i.indexOf(t)&&i.push(t)}this.getRfid(i,e),this.bindDialogStatus="bind",this.bindTemp={personId:e.id,teamId:e.teamId,rfidId:null,scanDeviceId:e.scanDeviceId},this.BindDialogFormVisible=!0},handleUnbind:function(e){null==e.rfidId&&(this.bindTypeOptions[1].disabled=!0),this.bindTemp={personId:e.id},this.bindDialogStatus="unbind",this.BindDialogFormVisible=!0},unbindSubmit:function(){var e=this;this.$refs["bindForm"].validate(function(t){var i,a;t&&(h=e.$loading({target:"#myDialog .el-dialog"}),i={personId:e.bindTemp.personId},1==e.bindTemp.type?a=r["m"]:2==e.bindTemp.type&&(a=r["l"]),a(i).then(function(t){0==t.status?(e.getList(),e.getSelect(),e.$message.success(t.msg),e.BindDialogFormVisible=!1):e.$message.error(t.msg)}).finally(function(){h.close()}))})},bindSubmit:function(){var e=this;this.$refs["bindForm"].validate(function(t){var i,a;t&&(h=e.$loading({target:"#myDialog .el-dialog"}),1==e.bindTemp.type?(i={personId:e.bindTemp.personId,teamId:e.bindTemp.teamId},a=r["d"]):2==e.bindTemp.type?(i={personId:e.bindTemp.personId,rfidId:e.bindTemp.rfidId},a=r["b"]):3==e.bindTemp.type&&(i={carId:e.bindTemp.carId,scanDeviceId:e.bindTemp.scanDeviceId},a=r["c"]),a(i).then(function(t){0==t.status?(e.getList(),e.$message.success(t.msg),e.BindDialogFormVisible=!1):e.$message.error(t.msg)}).finally(function(){h.close()}))})},getList:function(){var e=this,t=this;t.listLoading=!0,Object(r["g"])({page:this.listQuery.page,limit:this.listQuery.limit,status:[0,2]}).then(function(i){0==i.status?(e.list=i.data,e.total=i.count,e.indexMethod=(t.listQuery.page-1)*t.listQuery.limit+1):e.$message.error(i.msg)}).finally(function(){t.listLoading=!1})},handleFilter:function(){var e=this;if(""==this.listQuery.name||void 0==this.listQuery.name)return this.listQuery.name=null,void this.getList();Object(r["h"])({keyword:this.listQuery.name}).then(function(t){0==t.status?(e.listQuery.page=1,e.listLoading=!1,e.list=t.data,e.total=0):e.$message.error(t.msg)})},resetTemp:function(){this.temp={name:null,userCode:"",sex:1,age:"",officeTime:null,status:0,workTypes:[]}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs["dataForm"].clearValidate()})},createData:function(){var e=this;this.$refs["dataForm"].validate(function(t){if(!t)return!1;h=e.$loading({target:"#myDialog .el-dialog"}),e.temp.officeTime=new Date(e.temp.officeTimeShow).getTime();var i=Object(s["a"])({},e.temp);i.age||0===i.age||(i.age=-1),e.officeTime||delete i.officeTime,delete i.officeTimeShow,i.telNum||(i.telNum=""),i.address||(i.address=""),Object(r["e"])(i).then(function(t){0==t.status?(e.getList(),e.$message.success("添加成功"),e.dialogFormVisible=!1):e.$message.error(t.msg)}).finally(function(){h.close()})})},handleUpdate:function(e){var t=this;this.temp={id:e.id,userCode:e.userCode,sex:e.sex,status:e.status,workTypes:e.workTypes,officeTime:e.officeTime,officeTimeShow:e.officeTimeShow,address:e.address,telNum:e.telNum},this.initialWorkTypes=e.workTypes,-1!==e.age&&(this.temp.age=e.age),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},updateData:function(){var e=this;this.$refs["dataForm"].validate(function(t){if(!t)return!1;(function(){h=e.$loading({target:"#myDialog .el-dialog"});var t=Object(s["a"])({},e.temp);t.age||0===t.age||(t.age=-1),e.temp.officeTimeShow?t.officeTime=new Date(e.temp.officeTimeShow).getTime():delete t.officeTime,t.telNum||(t.telNum=""),t.address||(t.address="");var i=t.workTypes;delete t.officeTimeShow,delete t.workTypes;for(var a=[],n=[],l=function(a){-1==i.indexOf(e.initialWorkTypes[a])&&n.push(new Promise(function(i,n){Object(r["k"])({infoId:t.id,workType:e.initialWorkTypes[a]}).then(function(e){i()}).catch(function(){n()})}))},o=0;o<e.initialWorkTypes.length;o++)l(o);for(o=0;o<i.length;o++)-1==e.initialWorkTypes.indexOf(i[o])&&a.push(i[o]);var c=new Promise(function(e,i){Object(r["i"])(t).then(function(t){e()}).catch(function(){i()})}),d=new Promise(function(e,i){Object(r["a"])({infoId:t.id,workTypes:a}).then(function(t){e()}).catch(function(e){console.warn(e),i()})});Promise.all(n.concat([c,d])).then(function(t){e.getList(),e.$message.success("编辑成功")}).catch(function(t){e.$message.error("出错啦")}).finally(function(t){e.dialogFormVisible=!1,h.close()})})()})},handleDelete:function(e){var t=this,i=this;i.listLoading=!0,Object(r["f"])({personId:e.id}).then(function(e){0==e.status?(i.listQuery.page>1&&i.list.length<=1&&(i.listQuery.page-=1),t.getList(),i.$message.success("刪除成功")):(t.$message.error(e.msg),i.listLoading=!1)}).catch(function(e){i.listLoading=!1})},formatSexStatus:function(e){return 0==e?"女":1==e?"男":void 0},formatStatus:function(e){return 0==e?"在职":1==e?"离职":"请假"},formatPostStatus:function(e){var t,i=[];if(e){for(var a=0;a<e.length;a++)t=e[a],1==t?i.push("司机"):2==t?i.push("车组长"):3==t?i.push("押运员"):4==t?i.push("业务员"):5==t?i.push("大队长"):6==t?i.push("枪管员"):7==t?i.push("车管员"):8==t&&i.push("库管员");return i.toString()}},selectFilter:function(e,t,i,a,n,s){var l={};l=t.find(function(t){return t[i]===e}),this.temp[s]=l[a]},getRfid:function(e,t){var i=this,a=this;this.rfidOptions=[],Object(u["b"])({rfidType:e,status:[0]}).then(function(e){if(0==e.status){if(null==e.data)return;a.rfidOptions=e.data,a.rfidOptions.unshift({id:null,rfid:"请选择"})}else null==e.data&&(i.rfidOptions=[],i.rfidOptions.pop()),i.$message.error(e.msg)})},getSelect:function(){var e=this,t=this;Object(d["j"])({status:1}).then(function(i){if(0==i.status){if(null==i.data)return;t.largeTeamOptions=i.data,t.largeTeamOptions.unshift({id:-1,teamName:"请选择"})}else null==i.data&&(e.largeTeamOptions=[],e.largeTeamOptions.pop()),e.$message.error(i.msg)})},scrollTop:function(){var e=document.querySelector("#myDialog .el-dialog__body");e.scrollTop=0},tableRowClassName:function(e){e.row;var t=e.rowIndex;return t%2==0?"color-row":t%2==1?"noColor-row":""},exportExcel:function(){var e=this;this.exportLoading=!0,Object(d["b"])({excelType:4,title:"人员信息"}).then(function(t){try{var i=new TextDecoder("utf-8"),a=JSON.parse(i.decode(new Uint8Array(t)));e.$message({message:a.msg,type:"warning"})}catch(o){t.headers;var n="人员信息.xls",s=new Blob([t],{type:"application/excel"}),l=document.createElement("a");l.href=window.URL.createObjectURL(s),l.download=n,l.click(),l.remove()}}).finally(function(){e.exportLoading=!1})}}},v=y,k=(i("3a33"),i("2877")),w=Object(k["a"])(v,a,n,!1,null,null,null);t["default"]=w.exports},"3a33":function(e,t,i){"use strict";var a=i("fc86"),n=i.n(a);n.a},fc86:function(e,t,i){}}]);
//# sourceMappingURL=personnelFiles.4a46e396.js.map