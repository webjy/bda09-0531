(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2fbcacde"],{"0a6e":function(e,t,a){"use strict";a.d(t,"j",function(){return o}),a.d(t,"e",function(){return i}),a.d(t,"k",function(){return r}),a.d(t,"c",function(){return c}),a.d(t,"b",function(){return s}),a.d(t,"d",function(){return d}),a.d(t,"g",function(){return u}),a.d(t,"h",function(){return l}),a.d(t,"i",function(){return p}),a.d(t,"f",function(){return f}),a.d(t,"a",function(){return h});var n=a("2ade");function o(e){return Object(n["a"])({url:"/map/roadlist",method:"post",data:e})}function i(e){return Object(n["a"])({url:"/map/delete",method:"post",data:e})}function r(e){return Object(n["a"])({url:"/map/complexGeometry",method:"post",data:e})}function c(e){return Object(n["a"])({url:"/planRoad/list",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/planRoad/add",method:"post",data:e})}function d(e){return Object(n["a"])({url:"/planRoad/remove",method:"post",data:e})}function u(e){return Object(n["a"])({url:"/statistics/milesrange",method:"post",data:e,headers:{"content-type":"application/json"}})}function l(e){return Object(n["a"])({url:"/statistics/milesRangeByTeam",method:"post",data:e})}function p(e){return Object(n["a"])({url:"/eoms/groups/queryBindedGroupsByRoute",method:"post",data:e})}function f(e){return Object(n["a"])({url:"/eoms/groups/queryAllGroup",method:"post",data:e})}function h(e){return Object(n["a"])({url:"/eoms/groups/bindGroup",method:"post",data:e})}},ad19:function(e,t,a){"use strict";a.d(t,"g",function(){return o}),a.d(t,"f",function(){return i}),a.d(t,"h",function(){return r}),a.d(t,"d",function(){return c}),a.d(t,"c",function(){return s}),a.d(t,"e",function(){return d}),a.d(t,"j",function(){return u}),a.d(t,"a",function(){return l}),a.d(t,"b",function(){return p}),a.d(t,"i",function(){return f});var n=a("2ade");function o(e){return Object(n["a"])({url:"/cars/allList",method:"post",data:e})}function i(e){return Object(n["a"])({url:"/cars/allBindList",method:"post",data:e})}function r(e){return Object(n["a"])({url:"/guns/allList",method:"post",data:e})}function c(e){return Object(n["a"])({url:"/logs/delays",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/map/lastgps",method:"post",data:e,headers:{"content-type":"application/json"}})}function d(e){return Object(n["a"])({url:"/terminal/send",method:"post",data:e,headers:{"content-type":"application/json"}})}function u(e){return Object(n["a"])({url:"/proxy/StandardApiAction_vehicleControlOthers",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/eoms/relations/queryByCars",method:"post",data:e})}function p(e){return Object(n["a"])({url:"/eoms/relations/queryByGuns",method:"post",data:e})}function f(e){return Object(n["a"])({url:"/noapp/thirdparty/gaode/regeo",method:"post",data:e})}},b78f:function(e,t,a){e.exports=a.p+"img/mapicon.7621a9c3.png"},c29f:function(e,t,a){},f668:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.roadLoading,expression:"roadLoading"}],attrs:{id:"carBindRoad"}},[a("div",{staticClass:"chooseCar"},[a("label",{staticClass:"el-form-item__label"},[e._v("选择车辆")]),a("el-cascader",{attrs:{placeholder:"选择车辆",props:e.propsCar,options:e.dataCar,"show-all-levels":!1,clearable:"",filterable:""},on:{change:e.getCheckList},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,o=t.data;return[a("span",[e._v(e._s(o.label))]),n.isLeaf?e._e():a("span",[e._v(" ("+e._s(o.children.length)+") ")])]}}]),model:{value:e.imeiCar,callback:function(t){e.imeiCar=t},expression:"imeiCar"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.chooseShow,expression:"chooseShow"}],staticClass:"roads"},[a("label",{staticClass:"el-form-item__label"},[e._v("选择路线")]),a("el-checkbox-group",{staticClass:"checkList",model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.roadList,function(t,n){return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.checkListLoading,expression:"checkListLoading"}],key:n,staticClass:"group",class:{now:n==e.indexNow}},[a("el-checkbox",{attrs:{label:t.name,checked:t.checked},on:{change:function(a){return e.checkChange(t)}}}),a("i",{staticClass:"tip"},[e._v(e._s(t.info))]),a("span",{on:{click:function(a){return e.viewMap(t,n)}}},[e._v("查看路线")])],1)}),0)],1),a("div",{staticClass:"bindRoad"},[a("ins",{staticClass:"title"},[e._v("已绑定路线:")]),e._l(e.checkList,function(t,n){return a("span",{key:n},[e._v(e._s(t))])})],2),a("div",{ref:"map",staticClass:"map",class:{show:e.showMap}},[a("div",{staticClass:"title"},[a("span",[e._v(e._s(e.mapTitle))]),a("div",{staticClass:"close",on:{click:e.closeMap}},[e._v("×")])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.mapLoading,expression:"mapLoading"}],attrs:{id:"map"}})])])},o=[],i=(a("57e7"),a("28a5"),a("6d67"),a("7f7f"),a("ac6a"),a("f3e2"),a("ad19"),a("0a6e")),r=a("b78f"),c=a.n(r),s={data:function(){return{indexNow:-1,roadLoading:!0,mapLoading:!0,checkListLoading:!1,map:void 0,showMap:!1,mapTitle:"",imeiCar:[],dataCar:[],roadId2Name:{},roadObj:{},propsCar:{expandTrigger:"hover"},roadList:[],checkList:[],chooseShow:!1}},mounted:function(){var e=this;e.dataCar=e.formatCas(JSON.parse(sessionStorage.teamCarList),"serialNo","licenseNo"),Object(i["j"])({page:1,limit:1e4}).then(function(t){t.success&&(t.data.records.forEach(function(t){t.checked=!1,t.info="",e.roadId2Name[t.id]=t.name}),e.roadList=t.data.records)}).finally(function(){e.roadLoading=!1}),e.getCarRoadList(),e.map=new BMap.Map("map",{enableMapClick:!1}),e.map.centerAndZoom("潮州",13),e.map.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]})),e.map.enableScrollWheelZoom(!0)},methods:{formatCas:function(e,t,a){var n=[],o=0,i=function(i){var r=[];e[i].forEach(function(e){r.push({value:e[t],label:e[a],disabled:!1})}),n.push({value:"i".concat(o++),label:""==i?"未分组":i,children:r})};for(var r in e)i(r);return n},getCarRoadList:function(){var e=this;Object(i["c"])({}).then(function(t){t.success&&(e.roadObj=t.data)})},viewMap:function(e,t){var a=this,n=document.querySelector(".checkList"),o=100+n.offsetWidth+"px";a.indexNow!=t&&(a.$refs.map.style.left=o,a.indexNow=t,a.mapLoading=!0,a.mapTitle=e.name,a.showMap=!0,Object(i["k"])({geometryId:e.geometryId}).then(function(e){if(e.success){var t=e.data.geom.split(",").map(function(e){var t=e.split(" ");return e=new BMap.Point(t[0],t[1]),e});a.map.clearOverlays(),a.map.addOverlay(new BMap.Marker(t[0],{icon:new BMap.Icon(c.a,new BMap.Size(26,41),{anchor:new BMap.Size(13,40),imageOffset:new BMap.Size(-199,-139)})})),a.map.addOverlay(new BMap.Marker(t[t.length-1],{icon:new BMap.Icon(c.a,new BMap.Size(26,41),{anchor:new BMap.Size(13,40),imageOffset:new BMap.Size(-225,-139)})})),a.map.setViewport(t,{margins:[100,100,100,100]}),a.map.addOverlay(new BMap.Polyline(t,{strokeOpacity:1,strokeWeight:4,strokeColor:"#3f9c0f"}))}}).finally(function(){a.mapLoading=!1}))},closeMap:function(){var e=this;e.showMap=!1,e.indexNow=-1,e.map.clearOverlays(),e.map.reset()},getCheckList:function(e){var t=this;t.closeMap(),t.checkList=[],e.length>0?(t.chooseShow=!0,t.checkList=t.roadObj[e[1]].map(function(e){return t.roadId2Name[e.roadId]})):t.chooseShow=!1},checkChange:function(e){var t=this,a=t.imeiCar[1],n=e.id,o=t.checkList.indexOf(e.name);o>-1?(e.info="绑定中...",Object(i["b"])({deviceNo:a,roadId:n}).then(function(a){a.success&&(e.info="绑定成功",t.getCarRoadList())}).catch(function(a){e.info="绑定失败",t.checkList.splice(o,1),e.checked=!1}).finally(function(){setTimeout(function(){e.info=""},1500)})):(e.info="解绑中...",Object(i["d"])({deviceNo:a,roadId:n}).then(function(a){a.success&&(e.info="解绑成功",t.getCarRoadList())}).catch(function(a){e.info="解绑失败",t.checkList.push(e.name),e.checked=!0}).finally(function(){setTimeout(function(){e.info=""},1500)}))}}},d=s,u=(a("fa3a"),a("2877")),l=Object(u["a"])(d,n,o,!1,null,"7f1f9ce0",null);t["default"]=l.exports},fa3a:function(e,t,a){"use strict";var n=a("c29f"),o=a.n(n);o.a}}]);
//# sourceMappingURL=chunk-2fbcacde.4eab0787.js.map