(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["oilStatistics"],{1896:function(e,t,i){"use strict";var a=i("7bbd"),n=i.n(a);n.a},"1af6":function(e,t,i){var a=i("63b6");a(a.S,"Array",{isArray:i("9003")})},"20fd":function(e,t,i){"use strict";var a=i("d9f6"),n=i("aebd");e.exports=function(e,t,i){t in e?a.f(e,t,n(0,i)):e[t]=i}},"26ed":function(e,t,i){},"278b":function(e,t,i){"use strict";var a=i("c90c"),n=i.n(a);n.a},"333d":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[i("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},n=[];i("c5f6");Math.easeInOutQuad=function(e,t,i,a){return e/=a/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function l(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(e,t,i){var a=o(),n=e-a,s=20,u=0;t="undefined"===typeof t?500:t;var c=function e(){u+=s;var o=Math.easeInOutQuad(u,a,n,t);l(o),u<t?r(e):i&&"function"===typeof i&&i()};c()}var u={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.currentPage=1,this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&s(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&s(0,800)}}},c=u,d=(i("abce"),i("2877")),m=Object(d["a"])(c,a,n,!1,null,"2d3d4633",null);t["a"]=m.exports},"4b78":function(e,t,i){},"549b":function(e,t,i){"use strict";var a=i("d864"),n=i("63b6"),r=i("241e"),l=i("b0dc"),o=i("3702"),s=i("b447"),u=i("20fd"),c=i("7cd6");n(n.S+n.F*!i("4ee1")(function(e){Array.from(e)}),"Array",{from:function(e){var t,i,n,d,m=r(e),p="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,h=void 0!==g,v=0,b=c(m);if(h&&(g=a(g,f>2?arguments[2]:void 0,2)),void 0==b||p==Array&&o(b))for(t=s(m.length),i=new p(t);t>v;v++)u(i,v,h?g(m[v],v):m[v]);else for(d=b.call(m),i=new p;!(n=d.next()).done;v++)u(i,v,h?l(d,g,[n.value,v],!0):n.value);return i.length=v,i}})},"54a1":function(e,t,i){i("6c1c"),i("1654"),e.exports=i("95d5")},"54f9":function(e,t,i){"use strict";i.d(t,"f",function(){return n}),i.d(t,"c",function(){return r}),i.d(t,"i",function(){return l}),i.d(t,"e",function(){return o}),i.d(t,"g",function(){return s}),i.d(t,"k",function(){return u}),i.d(t,"j",function(){return c}),i.d(t,"a",function(){return d}),i.d(t,"l",function(){return m}),i.d(t,"b",function(){return p}),i.d(t,"d",function(){return f}),i.d(t,"h",function(){return g});var a=i("2ade");function n(e){return Object(a["a"])({url:"/refuel/page",method:"post",data:e})}function r(e){return Object(a["a"])({url:"/refuel/add",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/refuel/update",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/refuel/delete",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/refuel/fuzzyQuery",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/refuel/count",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/refuel/record",method:"post",data:e})}function d(e){return Object(a["a"])({url:"/refuel/addRecord",method:"post",data:e})}function m(e){return Object(a["a"])({url:"/refuel/updateRecord",method:"post",data:e})}function p(e){return Object(a["a"])({url:"/refuel/deleteRecord",method:"post",data:e})}function f(e){return Object(a["a"])({url:"/refuel/bind",method:"post",data:e})}function g(e){return Object(a["a"])({url:"/refuel/unbind",method:"post",data:e})}},5527:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container",attrs:{id:"carExps"}},[i("div",{staticClass:"filter-container"},[i("el-form",{staticClass:"filterTool",attrs:{inline:!0}},[i("el-form-item",[i("el-input",{staticClass:"filter-item searchInput",attrs:{placeholder:"设备号/车牌号"},model:{value:e.listQuery.iMei,callback:function(t){e.$set(e.listQuery,"iMei",t)},expression:"listQuery.iMei"}})],1),i("el-form-item",{staticClass:"dateRange"},[i("el-date-picker",{staticClass:"filter-item",attrs:{type:"daterange","range-separator":"至","value-format":"timestamp","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}})],1),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),i("el-button",{attrs:{type:"primary",icon:"iconfont icondaochu"},on:{click:e.exportExcel}},[e._v("导出")])],1),i("el-form",{ref:"ruleForm",staticClass:"filterTool filterTool1",attrs:{model:e.ruleForm,inline:!0,rules:e.rules}},[i("el-form-item",{staticClass:"filter-item doexcute",attrs:{prop:"value1"}},[i("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy_MM_dd","picker-options":e.pickerOptions},model:{value:e.ruleForm.value1,callback:function(t){e.$set(e.ruleForm,"value1",t)},expression:"ruleForm.value1"}})],1),i("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.excute}},[e._v("执行统计")])],1)],1),i("div",{staticClass:"tableBox"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"},{name:"show",rawName:"v-show",value:e.list.length>0,expression:"list.length>0"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{label:"序号",fixed:"",prop:"id",sortable:"custom",align:"center",width:"80",type:"index",index:e.indexMethod,"row-class-name":e.tableRowClassName}}),i("el-table-column",{attrs:{label:"车牌号",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.licenseNo))])]}}])}),i("el-table-column",{attrs:{label:"设备号",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.serialNo))])]}}])}),i("el-table-column",{attrs:{label:"所属大队",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.teamName?a.teamName:"未分组"))])]}}])}),i("el-table-column",{attrs:{label:"前一次上报时间",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.preTime))])]}}])}),i("el-table-column",{attrs:{label:"后一次上报时间",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.nextTime))])]}}])}),i("el-table-column",{attrs:{label:"间隔(S)",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.secondsFormat(t.row.intervalTime)))])]}}])}),i("el-table-column",{attrs:{label:"创建时间",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.formatDateTime(t.row.createTime)))])]}}])}),i("el-table-column",{attrs:{label:"距离(米)",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.distance))])]}}])}),1==e.power?i("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"300","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.playBack(a)}}},[e._v("回放")]),i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]}}],null,!1,2822503227)}):e._e()],1)],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit,layout:"prev, pager, next, sizes, total, jumper"},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:function(t){return e.handleFilter("pagination")}}})],1)},n=[],r=(i("34ef"),i("ac6a"),i("f3e2"),i("c5f6"),i("28a5"),i("bd86")),l=(i("78ce"),i("333d")),o=i("2ade");function s(e){return Object(o["a"])({url:"/carExps/page",method:"post",data:e})}function u(e){return Object(o["a"])({url:"/carExps/delete",method:"post",data:e})}function c(e){return Object(o["a"])({url:"/carExps/fuzzyQuery",method:"post",data:e})}function d(e){return Object(o["a"])({url:"/carExps/count",method:"post",data:e})}i("c31b");var m=i("66e8"),p=i("69d9"),f={name:"gunFiles",components:{Pagination:l["a"]},data:function(){return Object(r["a"])({pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()-864e5}},ruleForm:{value1:""},rules:{value1:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}]},value1:null,power:JSON.parse(sessionStorage.getItem("userInfo")).Power,tableKey:0,list:[],total:0,indexMethod:1,listLoading:!1,listQuery:{page:1,limit:10,iMei:void 0}},"pickerOptions",{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]})},created:function(){this.handleFilter()},methods:{time_to_sec:function(e){var t="",i=e.split(":")[0],a=e.split(":")[1],n=e.split(":")[2];return t=Number(3600*i)+Number(60*a)+Number(n),t},sec_to_time:function(e){var t;if(e>-1){var i=Math.floor(e/3600),a=Math.floor(e/60)%60,n=e%60;t=i<10?"0"+i+":":i+":",a<10&&(t+="0"),t+=a+":",n<10&&(t+="0"),t+=n}return t},dealDate:function(){var e=this;function t(e){var t=new Date(e),i=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();return a=a<10?"0"+a:a,n=n<10?"0"+n:n,"".concat(i,"_").concat(a,"_").concat(n)}if(!e.value1||0==e.value1.length)return[];for(var i=864e5,a=e.value1[0],n=e.value1[1]+i-1,r=Math.ceil((n-a)/i),l=[],o=0;o<r;o++){var s=t(a+i*o);l.push(s)}return l},playBack:function(e){var t="00:00:00",i="23:59:59",a=this.time_to_sec(e.preTime.split(" ")[1])-60,n=this.time_to_sec(e.nextTime.split(" ")[1])+60;a>0&&(t=this.sec_to_time(a)),n<86400&&(i=this.sec_to_time(n)),this.$router.push({name:"historicalPlayback",query:{imei:e.licenseNo,type:"car",year:e.preTime.split(" ")[0],start:t,end:i}})},formatDateTime:function(e){return e?Object(p["d"])(e,1):e},secondsFormat:function(e){var t=Math.floor(e/86400),i=Math.floor((e-24*t*3600)/3600),a=Math.floor((e-24*t*3600-3600*i)/60),n=e-24*t*3600-3600*i-60*a;return t+"天"+i+"时"+a+"分"+n+"秒"},excute:function(){var e=this,t=this;t.$refs.ruleForm.validate(function(i){if(i){if(!e.ruleForm.value1)return void e.$message.warning("请选择日期");d({tableName:e.ruleForm.value1}).then(function(t){0==t.status?e.$message.success(t.msg):e.$message.error(t.msg)}).finally(function(){t.listLoading=!1})}})},getList:function(){var e=this,t=this;t.listLoading=!0,s({page:this.listQuery.page,limit:this.listQuery.limit}).then(function(i){0==i.status?(e.listLoading=!1,e.list=i.data,e.list.forEach(function(t,i){-1==e.list[i].battery&&(e.list[i].battery=null),-1==e.list[i].teamId&&(e.list[i].teamId=null,e.list[i].teamName=null),-1==e.list[i].securityId&&(e.list[i].securityId=null,e.list[i].securityName=null)}),e.total=i.count,e.indexMethod=(t.listQuery.page-1)*t.listQuery.limit+1):e.$message.error(i.msg)}).finally(function(){t.listLoading=!1})},handleFilter:function(e){var t=this;"pagination"!==e&&(this.listQuery.page=1),this.listLoading=!0,void 0!=this.listQuery.iMei&&null!=this.listQuery.iMei||(this.listQuery.iMei=""),this.value1||(this.value1=[]),c({keyword:this.listQuery.iMei,tableName:this.dealDate(),page:this.listQuery.page,limit:this.listQuery.limit}).then(function(e){0==e.status?(t.listLoading=!1,null==e.data||0==e.data.length?(t.list=[],t.$message.success("无数据")):t.list=e.data,t.indexMethod=(t.listQuery.page-1)*t.listQuery.limit+1,t.total=e.count):t.$message.error(e.msg)})},handleDelete:function(e){var t=this,i=this;i.listLoading=!0,u({id:e.id}).then(function(e){0==e.status?(i.listQuery.page>1&&i.list.length<=1&&(i.listQuery.page-=1),t.handleFilter(),i.$message.success("刪除成功"),t.$store.commit("realTimeMonitor/ISEDITFILES",!0)):(t.$message.error(e.msg),i.listLoading=!1)}).catch(function(e){i.listLoading=!1,console.error(e)})},tableRowClassName:function(e){e.row;var t=e.rowIndex;return t%2==0?"color-row":t%2==1?"noColor-row":""},exportExcel:function(){var e=this,t=this.dealDate();Object(m["b"])({dates:t,excelType:11,title:"车辆异常信息"}).then(function(i){try{var a=new TextDecoder("utf-8"),n=JSON.parse(a.decode(new Uint8Array(i)));e.$message({message:n.msg,type:"warning"})}catch(u){i.headers;var r="";t.length>1&&(r=t[t.length-1]);var l="";l=0==t.length?"车辆异常信息.xls":t[0]+"----"+r+"车辆异常信息.xls";var o=new Blob([i],{type:"application/excel"}),s=document.createElement("a");s.href=window.URL.createObjectURL(o),s.download=l,s.click(),s.remove()}})}}},g=f,h=(i("d4f5"),i("2877")),v=Object(h["a"])(g,a,n,!1,null,null,null);t["default"]=v.exports},"5e2b":function(e,t,i){},"66e8":function(e,t,i){"use strict";i.d(t,"j",function(){return n}),i.d(t,"g",function(){return r}),i.d(t,"i",function(){return l}),i.d(t,"a",function(){return o}),i.d(t,"f",function(){return s}),i.d(t,"e",function(){return u}),i.d(t,"b",function(){return c}),i.d(t,"k",function(){return d}),i.d(t,"c",function(){return m}),i.d(t,"h",function(){return p}),i.d(t,"d",function(){return f});var a=i("2ade");function n(e){return Object(a["a"])({url:"teams/select",method:"post",data:e})}function r(e){return Object(a["a"])({url:"persons/select",method:"post",data:e})}function l(e){return Object(a["a"])({url:"persons/selectByCondition",method:"post",data:e,headers:{"content-type":"application/json"}})}function o(e){return Object(a["a"])({url:"cars/select",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/map/routeByStatus",method:"post",data:e})}function u(e){return Object(a["a"])({url:"logs/invoke",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/file/exportExcel",method:"post",data:e,responseType:"arraybuffer",headers:{"content-type":"application/json"}})}function d(e){return Object(a["a"])({url:"/noapp/file/xxx/upload",method:"post",data:e})}function m(e){return Object(a["a"])({url:"/file/importExcel",method:"post",data:e})}function p(e){return Object(a["a"])({url:"/eoms/schedulings/queryTaskByIds",method:"post",data:e})}function f(e){return Object(a["a"])({url:"/file/importFile",method:"post",data:e})}},"69d9":function(e,t,i){"use strict";i.d(t,"d",function(){return a}),i.d(t,"c",function(){return n}),i.d(t,"e",function(){return r}),i.d(t,"a",function(){return l}),i.d(t,"b",function(){return o});i("ac6a"),i("f3e2"),i("8ea5"),i("a481"),i("0298"),i("df7c");function a(e,t){var i=new Date(e),a=i.getFullYear(),r=n(i.getMonth()+1),l=n(i.getDate()),o=n(i.getHours()),s=n(i.getMinutes()),u=n(i.getSeconds());return 1==t?a+"-"+r+"-"+l+" "+o+":"+s+":"+u:a+"-"+r+"-"+l}function n(e){return e<10?"0"+e:e}function r(e){var t=new Date(e).toJSON();return new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")}function l(e){var t=m(e.lat,e.lng),i=new BMap.Point(t[1],t[0]);return i}function o(e){var t=[];return e.forEach(function(e){var i=m(e.lat,e.lng),a=new BMap.Point(i[1],i[0]);t.push(a)}),t}var s=3.141592653589793,u=6378245,c=.006693421622965943,d=52.35987755982988;function m(e,t){var i=f(e,t),a=p(i[0],i[1]);return a}function p(e,t){var i=t,a=e,n=Math.sqrt(i*i+a*a)+2e-5*Math.sin(a*d),r=Math.atan2(a,i)+3e-6*Math.cos(i*d),l=n*Math.cos(r)+.0065,o=n*Math.sin(r)+.006,s=[];return s.push(o),s.push(l),s}function f(e,t){var i=g(t-105,e-35),a=h(t-105,e-35),n=e/180*s,r=Math.sin(n);r=1-c*r*r;var l=Math.sqrt(r);i=180*i/(u*(1-c)/(r*l)*s),a=180*a/(u/l*Math.cos(n)*s);var o=e+i,d=t+a,m=[];return m.push(o),m.push(d),m}function g(e,t){var i=2*e-100+3*t+.2*t*t+.1*e*t+.2*Math.sqrt(Math.abs(e));return i+=2*(20*Math.sin(6*e*s)+20*Math.sin(2*e*s))/3,i+=2*(20*Math.sin(t*s)+40*Math.sin(t/3*s))/3,i+=2*(160*Math.sin(t/12*s)+320*Math.sin(t*s/30))/3,i}function h(e,t){var i=300+e+2*t+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return i+=2*(20*Math.sin(6*e*s)+20*Math.sin(2*e*s))/3,i+=2*(20*Math.sin(e*s)+40*Math.sin(e/3*s))/3,i+=2*(150*Math.sin(e/12*s)+300*Math.sin(e/30*s))/3,i}},"6fa7":function(e,t,i){"use strict";var a=i("26ed"),n=i.n(a);n.a},"75fc":function(e,t,i){"use strict";var a=i("a745"),n=i.n(a);function r(e){if(n()(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}var l=i("774e"),o=i.n(l),s=i("c8bb"),u=i.n(s);function c(e){if(u()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return o()(e)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function m(e){return r(e)||c(e)||d()}i.d(t,"a",function(){return m})},"774e":function(e,t,i){e.exports=i("d2d5")},"7bbd":function(e,t,i){},"95d5":function(e,t,i){var a=i("40c3"),n=i("5168")("iterator"),r=i("481b");e.exports=i("584a").isIterable=function(e){var t=Object(e);return void 0!==t[n]||"@@iterator"in t||r.hasOwnProperty(a(t))}},"9a2c":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container",attrs:{id:"carMaintain"}},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",attrs:{placeholder:"车牌号/油卡号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.iMei,callback:function(t){e.$set(e.listQuery,"iMei",t)},expression:"listQuery.iMei"}}),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),1==e.power?i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.handleCreate}},[e._v("添加")]):e._e(),i("el-button",{staticClass:"filter-item filter-item-btn",attrs:{type:"primary",icon:"iconfont icondaochu"},on:{click:e.exportExcel}},[e._v("导出")])],1),i("div",{staticClass:"tableBox"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,fit:"","highlight-current-row":"","row-class-name":e.tableRowClassName}},[i("el-table-column",{attrs:{label:"序号",fixed:"",prop:"id",sortable:"custom",align:"center",width:"80",type:"index",index:e.indexMethod}}),i("el-table-column",{attrs:{label:"车牌号",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.licenseNo))])]}}])}),i("el-table-column",{attrs:{label:"计划保养日期",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.formatDateTime(a.planMaintainTime)))])]}}])}),i("el-table-column",{attrs:{label:"计划保养里程",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.planMaintainMileage))])]}}])}),i("el-table-column",{attrs:{label:"推荐保养日期",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.formatDateTime(a.adviceMaintainTime)))])]}}])}),i("el-table-column",{attrs:{label:"在当前保养周期内已运行的里程",minWidth:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.currentMileage))])]}}])}),i("el-table-column",{attrs:{label:"最后一次保养的时间",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.formatDateTime(a.latestMaintainTime)))])]}}])}),i("el-table-column",{attrs:{label:"所属大队",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(""==a.teamName?"未分组":a.teamName))])]}}])}),1==e.power?i("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"300","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[1==e.power?i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit-outline"},on:{click:function(t){return e.handleUpdate(a)}}},[e._v("编辑")]):e._e(),1==e.power?i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")]):e._e()]}}],null,!1,3843857286)}):e._e()],1)],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit,layout:"prev, pager, next, sizes, total, jumper"},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}}),i("el-dialog",{attrs:{id:"myDialog",title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:"dataForm",staticClass:"formStyle",attrs:{rules:e.rules,model:e.temp,"label-position":"left"}},["create"==e.dialogStatus?i("el-form-item",{attrs:{label:"车牌号",prop:"licenseNo"}},[i("el-input",{model:{value:e.temp.licenseNo,callback:function(t){e.$set(e.temp,"licenseNo",t)},expression:"temp.licenseNo"}})],1):e._e(),i("el-form-item",{attrs:{label:"上次保养日期",prop:"latestMaintainTime"}},[i("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.temp.latestMaintainTime,callback:function(t){e.$set(e.temp,"latestMaintainTime",t)},expression:"temp.latestMaintainTime"}})],1),i("el-form-item",{attrs:{label:"计划保养里程",prop:"planMaintainMileage"}},[i("el-input",{attrs:{placeholder:"单位：公里"},model:{value:e.temp.planMaintainMileage,callback:function(t){e.$set(e.temp,"planMaintainMileage",t)},expression:"temp.planMaintainMileage"}})],1),i("el-form-item",{attrs:{label:"计划保养日期",prop:"planMaintainTime"}},[i("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.temp.planMaintainTime,callback:function(t){e.$set(e.temp,"planMaintainTime",t)},expression:"temp.planMaintainTime"}})],1),i("el-form-item",{staticClass:"special",attrs:{label:"距离上次保养已行驶的里程",prop:"currentMileage"}},[i("el-input",{attrs:{placeholder:"单位：公里"},model:{value:e.temp.currentMileage,callback:function(t){e.$set(e.temp,"currentMileage",t)},expression:"temp.currentMileage"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():"update"===e.dialogStatus?e.updateData():e.maintain()}}},[e._v("确定")])],1)],1)],1)},n=[],r=(i("34ef"),i("c5f6"),i("333d")),l=i("2ade");function o(e){return Object(l["a"])({url:"/maintains/page",method:"post",data:e})}function s(e){return Object(l["a"])({url:"/maintains/add",method:"post",data:e})}function u(e){return Object(l["a"])({url:"/maintains/update",method:"post",data:e})}function c(e){return Object(l["a"])({url:"/maintains/delete",method:"post",data:e})}function d(e){return Object(l["a"])({url:"/maintains/fuzzyQuery",method:"post",data:e})}function m(e){return Object(l["a"])({url:"/maintains/execute",method:"post",data:e})}var p=i("69d9"),f=i("66e8"),g=void 0,h={name:"carMaintain",components:{Pagination:r["a"]},data:function(){return{power:JSON.parse(sessionStorage.getItem("userInfo")).Power,tableKey:0,list:null,total:0,indexMethod:1,listLoading:!1,listQuery:{page:1,limit:10,iMei:void 0},temp:{planMaintainTime:void 0,licenseNo:void 0,planMaintainMileage:void 0,currentMileage:void 0,maintainTime:void 0,latestMaintainTime:void 0},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"添加",maintain:"保养"},rules:{licenseNo:[{required:!0,message:"请填写车牌号",trigger:"blur"}],latestMaintainTime:[{required:!0,message:"请选择上次保养日期",trigger:"blur"}],maintainTime:[{required:!0,message:"请选择保养日期",trigger:"blur"}],planMaintainTime:[{required:!0,message:"请选择计划保养日期",trigger:"blur"}],planMaintainMileage:[{required:!0,message:"请填写计划保养里程",trigger:"blur"}],currentMileage:[{required:!0,message:"请填写距离上次保养已行驶的里程",trigger:"blur"}]}}},created:function(){this.getList()},methods:{formatDateTime:function(e){return e?Object(p["d"])(e,1):e},getList:function(){var e=this,t=this;t.listLoading=!0,o({page:t.listQuery.page,limit:t.listQuery.limit}).then(function(i){0==i.status?(e.listLoading=!1,null==i.data?e.list=[]:e.list=i.data,e.total=i.count,e.indexMethod=(t.listQuery.page-1)*t.listQuery.limit+1):e.$message.error(i.msg)}).finally(function(){t.listLoading=!1})},handleFilter:function(){var e=this;if(""==this.listQuery.iMei||void 0==this.listQuery.iMei)return this.listQuery.iMei=null,void this.getList();d({keyword:this.listQuery.iMei}).then(function(t){0==t.status?(e.listQuery.page=1,e.listLoading=!1,e.list=[],e.list=t.data,e.total=0):e.$message.error(t.msg)})},resetTemp:function(){this.temp={planMaintainTime:void 0,licenseNo:void 0,planMaintainMileage:void 0,currentMileage:void 0,maintainTime:void 0,latestMaintainTime:void 0}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs["dataForm"].clearValidate()})},createData:function(){var e=this;this.$refs["dataForm"].validate(function(t){if(!t)return!1;g=e.$loading({target:"#myDialog .el-dialog"}),s({planMaintainTime:e.temp.planMaintainTime.getTime(),licenseNo:e.temp.licenseNo,planMaintainMileage:Number(e.temp.planMaintainMileage),currentMileage:Number(e.temp.currentMileage),latestMaintainTime:e.temp.latestMaintainTime.getTime()}).then(function(t){0==t.status?(e.getList(),e.$message.success(t.msg),e.dialogFormVisible=!1):e.$message.error(t.msg)}).finally(function(){g.close()})})},handleUpdate:function(e){var t=this;this.temp={latestMaintainTime:Object(p["d"])(e.latestMaintainTime,1),planMaintainTime:Object(p["d"])(e.planMaintainTime,1),planMaintainMileage:e.planMaintainMileage,currentMileage:e.currentMileage,id:e.id},this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},updateData:function(){var e=this,t=this;this.$refs["dataForm"].validate(function(i){if(!i)return!1;g=e.$loading({target:"#myDialog .el-dialog"}),u({planMaintainTime:new Date(t.temp.planMaintainTime).getTime(),planMaintainMileage:Number(t.temp.planMaintainMileage),id:e.temp.id,currentMileage:Number(t.temp.currentMileage),latestMaintainTime:new Date(t.temp.latestMaintainTime).getTime()}).then(function(t){0==t.status?(e.getList(),e.$message.success(t.msg),e.dialogFormVisible=!1):e.$message.error(t.msg)}).finally(function(){g.close()})})},handleDelete:function(e){var t=this,i=this;i.listLoading=!0,c({id:e.id}).then(function(e){0==e.status?(i.listQuery.page>1&&i.list.length<=1&&(i.listQuery.page-=1),t.getList(),i.$message.success("刪除成功")):(t.$message.error(e.msg),i.listLoading=!1)}).catch(function(e){i.listLoading=!1})},check:function(e){var t=this;this.resetTemp(),this.temp.licenseNo=e.licenseNo,this.dialogStatus="maintain",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},maintain:function(e){var t=this;this.$refs["dataForm"].validate(function(e){if(!e)return!1;g=t.$loading({target:"#myDialog .el-dialog"}),m({maintainTime:t.temp.maintainTime.getTime(),licenseNo:t.temp.licenseNo,newPlanMaintainTime:t.temp.planMaintainTime.getTime(),newPlanMaintainMileage:Number(t.temp.planMaintainMileage)}).then(function(e){0==e.status?(t.getList(),t.$message.success(e.msg),t.dialogFormVisible=!1):t.$message.error(e.msg)}).finally(function(){g.close()})})},tableRowClassName:function(e){e.row;var t=e.rowIndex;return t%2==0?"color-row":t%2==1?"noColor-row":""},exportExcel:function(){var e=this;Object(f["b"])({excelType:15,title:"车辆保养记录"}).then(function(t){try{var i=new TextDecoder("utf-8"),a=JSON.parse(i.decode(new Uint8Array(t)));e.$message({message:a.msg,type:"warning"})}catch(o){t.headers;var n="车辆保养记录.xls",r=new Blob([t],{type:"application/excel"}),l=document.createElement("a");l.href=window.URL.createObjectURL(r),l.download=n,l.click(),l.remove()}})}}},v=h,b=(i("1896"),i("2877")),y=Object(b["a"])(v,a,n,!1,null,null,null);t["default"]=y.exports},a745:function(e,t,i){e.exports=i("f410")},abce:function(e,t,i){"use strict";var a=i("e052"),n=i.n(a);n.a},c31b:function(e,t,i){"use strict";i.d(t,"l",function(){return n}),i.d(t,"d",function(){return r}),i.d(t,"k",function(){return l}),i.d(t,"n",function(){return o}),i.d(t,"h",function(){return s}),i.d(t,"a",function(){return u}),i.d(t,"p",function(){return c}),i.d(t,"o",function(){return d}),i.d(t,"b",function(){return m}),i.d(t,"q",function(){return p}),i.d(t,"c",function(){return f}),i.d(t,"r",function(){return g}),i.d(t,"j",function(){return h}),i.d(t,"f",function(){return v}),i.d(t,"e",function(){return b}),i.d(t,"i",function(){return y}),i.d(t,"g",function(){return w}),i.d(t,"m",function(){return x});var a=i("2ade");function n(e){return Object(a["a"])({url:"/cars/list",method:"post",data:e})}function r(e){return Object(a["a"])({url:"/cars/add",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/cars/delete",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/cars/update",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/cars/query",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/cars/addBatch",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/params/setPause",method:"post",data:e,headers:{"content-type":"application/json"}})}function d(e){return Object(a["a"])({url:"/cars/scrap",method:"post",data:e})}function m(e){return Object(a["a"])({url:"/cars/bindDriver",method:"post",data:e})}function p(e){return Object(a["a"])({url:"/cars/unbindDriver",method:"post",data:e})}function f(e){return Object(a["a"])({url:"/cars/bindTeam",method:"post",data:e})}function g(e){return Object(a["a"])({url:"/cars/unbindTeam",method:"post",data:e})}function h(e){return Object(a["a"])({url:"/cars/unbindScanDevice",method:"post",data:e})}function v(e){return Object(a["a"])({url:"/cars/bindScanDevice",method:"post",data:e})}function b(e){return Object(a["a"])({url:"/cars/bindRfid",method:"post",data:e})}function y(e){return Object(a["a"])({url:"/cars/unbindRfid",method:"post",data:e})}function w(e,t){return Object(a["a"])({url:"/cars/detail",method:"post",data:e,cancelToken:t})}function x(e){return Object(a["a"])({url:"/cars/bindPhoto",method:"post",data:e})}},c7d8:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container",attrs:{id:"oilStatistics"}},[i("div",{staticClass:"filter-container"},[i("el-date-picker",{staticClass:"filter-item dateRange",attrs:{type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}}),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),i("el-button",{attrs:{type:"primary",icon:"iconfont icondaochu"},on:{click:e.exportExcel}},[e._v("导出")])],1),i("div",{staticClass:"tableBox"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{"default-sort":{prop:"totalRefuel",order:"descending"},data:e.list.slice((e.currpage-1)*e.pagesize,e.currpage*e.pagesize),fit:"","highlight-current-row":"","row-class-name":e.tableRowClassName},on:{"sort-change":e.tableSortChange}},[i("el-table-column",{attrs:{label:"序号",fixed:"",prop:"id",sortable:"custom",align:"center",width:"80",type:"index",index:e.indexMethod}}),i("el-table-column",{attrs:{label:"油卡号",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[1==e.power?i("span",{staticClass:"link-type"},[e._v(e._s(a.fuelcardNo))]):i("span",[e._v(e._s(a.fuelcardNo))])]}}])}),i("el-table-column",{attrs:{label:"车牌号",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.licenseNo))])]}}])}),i("el-table-column",{attrs:{sortable:"",prop:"totalRefuel",label:"加油量总计",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.totalRefuel))])]}}])}),i("el-table-column",{attrs:{prop:"totalPrice",sortable:"",label:"加油金额总计",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.totalPrice))])]}}])})],1)],1),i("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{background:"",layout:"prev, pager, next, sizes, total, jumper","page-sizes":[5,10,15,20],"page-size":e.pagesize,"current-page":e.currpage,total:e.list.length},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)},n=[],r=(i("34ef"),i("55dd"),i("75fc")),l=(i("78ce"),i("333d")),o=i("54f9"),s=i("69d9"),u=i("66e8"),c={name:"oilStatistics",components:{Pagination:l["a"]},data:function(){return{power:JSON.parse(sessionStorage.getItem("userInfo")).Power,tableKey:0,list:[],list1:[],total:0,currpage:1,pagesize:10,indexMethod:1,listLoading:!1,listQuery:{page:1,limit:10,iMei:void 0},sort:{order:void 0,prop:void 0},textMap:{update:"编辑",create:"添加"},rules:{fuelcardNo:[{required:!0,message:"请填写油卡号",trigger:"blur"}],licenseNo:[{required:!0,message:"请填写车牌号",trigger:"blur"}]},pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-7776e6),e.$emit("pick",[i,t])}}]},timeRange:[(new Date).setTime((new Date).getTime()-6048e5),new Date]}},created:function(){this.getList()},methods:{formatDateTime:function(e){return Object(s["d"])(e,1)},getList:function(){var e=this,t=this;t.listLoading=!0,Object(o["k"])({endTime:new Date(this.timeRange[1]).getTime(),startTime:new Date(this.timeRange[0]).getTime()}).then(function(i){0==i.status?(e.listLoading=!1,null==i.data?(e.list=[],e.list1=[]):(e.list=i.data,e.list1=Object(r["a"])(i.data)),e.sortChange(),e.total=e.list.length,e.indexMethod=(t.currpage-1)*t.pagesize+1):e.$message.error(i.msg)}).finally(function(){t.listLoading=!1})},sortChange:function(){"descending"===this.sort.order?this.list=this.list.sort(this.sortBy(this.sort.prop,!1)):"ascending"===this.sort.order?this.list=this.list.sort(this.sortBy(this.sort.prop,!0)):this.list=Object(r["a"])(this.list1)},tableSortChange:function(e){this.sort.order=e.order,this.sort.prop=e.prop,this.currpage=1,"descending"===e.order?this.list=this.list.sort(this.sortBy(e.prop,!1)):"ascending"===e.order?this.list=this.list.sort(this.sortBy(e.prop,!0)):this.list=Object(r["a"])(this.list1)},sortBy:function(e,t){return t=void 0==t?1:t?1:-1,function(i,a){return i=i[e],a=a[e],i<a?-1*t:i>a?1*t:0}},handleFilter:function(){var e=this;if(""==this.listQuery.iMei||void 0==this.listQuery.iMei)return this.listQuery.iMei=null,void this.getList();oilCarSearch({keyword:this.listQuery.iMei}).then(function(t){0==t.status?(e.listQuery.page=1,e.listLoading=!1,e.list=[],e.list=t.data,e.total=1):e.$message.error(t.msg)})},handleCurrentChange:function(e){this.sortChange(),this.currpage=e,this.indexMethod=(this.currpage-1)*this.pagesize+1},handleSizeChange:function(e){this.sortChange(),this.pagesize=e,this.indexMethod=(this.currpage-1)*this.pagesize+1},scrollTop:function(){var e=document.querySelector("#myDialog .el-dialog__body");e.scrollTop=0},tableRowClassName:function(e){e.row;var t=e.rowIndex;return t%2==0?"color-row":t%2==1?"noColor-row":""},exportExcel:function(){var e=this,t=[];this.timeRange&&this.timeRange.length&&(t[0]=new Date(this.timeRange[0]).getTime(),t[1]=new Date(this.timeRange[1]).getTime()),Object(u["b"])({dates:t,excelType:14,title:"加油记录统计"}).then(function(i){try{var a=new TextDecoder("utf-8"),n=JSON.parse(a.decode(new Uint8Array(i)));e.$message({message:n.msg,type:"warning"})}catch(u){i.headers;var r="";r=0==t.length?"加油记录统计.xls":Object(s["d"])(e.timeRange[0],1)+"----"+Object(s["d"])(e.timeRange[1],1)+"加油记录统计.xls";var l=new Blob([i],{type:"application/excel"}),o=document.createElement("a");o.href=window.URL.createObjectURL(l),o.download=r,o.click(),o.remove()}})}}},d=c,m=(i("278b"),i("2877")),p=Object(m["a"])(d,a,n,!1,null,null,null);t["default"]=p.exports},c8bb:function(e,t,i){e.exports=i("54a1")},c90c:function(e,t,i){},d251:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container",attrs:{id:"gunExps"}},[i("div",{staticClass:"filter-container"},[i("el-form",{staticClass:"filterTool",attrs:{inline:!0}},[i("el-form-item",{staticStyle:{width:"150px"}},[i("el-input",{staticClass:"filter-item searchInput",attrs:{placeholder:"设备号/枪号"},model:{value:e.listQuery.iMei,callback:function(t){e.$set(e.listQuery,"iMei",t)},expression:"listQuery.iMei"}})],1),i("el-form-item",{staticClass:"dateRange"},[i("el-date-picker",{staticClass:"filter-item",attrs:{type:"daterange","range-separator":"至","value-format":"timestamp","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}})],1),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),i("el-button",{attrs:{type:"primary",icon:"iconfont icondaochu"},on:{click:e.exportExcel}},[e._v("导出")])],1),i("el-form",{ref:"ruleForm",staticClass:"filterTool filterTool1",attrs:{model:e.ruleForm,inline:!0,rules:e.rules}},[i("el-form-item",{staticClass:"filter-item doexcute",attrs:{prop:"value1"}},[i("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy_MM_dd","picker-options":e.pickerOptions},model:{value:e.ruleForm.value1,callback:function(t){e.$set(e.ruleForm,"value1",t)},expression:"ruleForm.value1"}})],1),i("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.excute}},[e._v("执行统计")])],1)],1),i("div",{staticClass:"tableBox"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"},{name:"show",rawName:"v-show",value:e.list.length>0,expression:"list.length>0"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,fit:"","highlight-current-row":"","row-class-name":e.tableRowClassName}},[i("el-table-column",{attrs:{label:"序号",fixed:"",prop:"id",sortable:"custom",align:"center",width:"80",type:"index",index:e.indexMethod}}),i("el-table-column",{attrs:{label:"枪号",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.code))])]}}])}),i("el-table-column",{attrs:{label:"设备号",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.iMei))])]}}])}),i("el-table-column",{attrs:{label:"所属大队",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.teamName?a.teamName:"未分组"))])]}}])}),i("el-table-column",{attrs:{label:"前一次上报时间",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.preTime))])]}}])}),i("el-table-column",{attrs:{label:"后一次上报时间",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.nextTime))])]}}])}),i("el-table-column",{attrs:{label:"间隔(S)",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.secondsFormat(t.row.intervalTime)))])]}}])}),i("el-table-column",{attrs:{label:"创建时间",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.formatDateTime(t.row.createTime)))])]}}])}),i("el-table-column",{attrs:{label:"距离(米)",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.distance))])]}}])}),1==e.power?i("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"300","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.playBack(a)}}},[e._v("回放")]),i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]}}],null,!1,2822503227)}):e._e()],1)],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit,layout:"prev, pager, next, sizes, total, jumper"},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:function(t){return e.handleFilter("pagination")}}})],1)},n=[],r=(i("c5f6"),i("28a5"),i("bd86")),l=(i("78ce"),i("333d")),o=i("2ade");function s(e){return Object(o["a"])({url:"/gunExps/page",method:"post",data:e})}function u(e){return Object(o["a"])({url:"/gunExps/delete",method:"post",data:e})}function c(e){return Object(o["a"])({url:"/gunExps/fuzzyQuery",method:"post",data:e})}function d(e){return Object(o["a"])({url:"/gunExps/count",method:"post",data:e})}var m=i("69d9"),p=i("66e8"),f={name:"gunFiles",components:{Pagination:l["a"]},data:function(){return Object(r["a"])({pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()-864e5}},ruleForm:{value1:""},rules:{value1:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}]},value1:[],power:JSON.parse(sessionStorage.getItem("userInfo")).Power,tableKey:0,list:[],total:0,indexMethod:1,listLoading:!1,listQuery:{page:1,limit:10,iMei:void 0}},"pickerOptions",{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]})},created:function(){this.handleFilter()},methods:{time_to_sec:function(e){var t="",i=e.split(":")[0],a=e.split(":")[1],n=e.split(":")[2];return t=Number(3600*i)+Number(60*a)+Number(n),t},sec_to_time:function(e){var t;if(e>-1){var i=Math.floor(e/3600),a=Math.floor(e/60)%60,n=e%60;t=i<10?"0"+i+":":i+":",a<10&&(t+="0"),t+=a+":",n<10&&(t+="0"),t+=n}return t},dealDate:function(){var e=this;function t(e){var t=new Date(e),i=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();return a=a<10?"0"+a:a,n=n<10?"0"+n:n,"".concat(i,"_").concat(a,"_").concat(n)}if(!e.value1||0==e.value1.length)return[];for(var i=864e5,a=e.value1[0],n=e.value1[1]+i-1,r=Math.ceil((n-a)/i),l=[],o=0;o<r;o++){var s=t(a+i*o);l.push(s)}return l},playBack:function(e){var t="00:00:00",i="23:59:59",a=this.time_to_sec(e.preTime.split(" ")[1])-60,n=this.time_to_sec(e.nextTime.split(" ")[1])+60;a>0&&(t=this.sec_to_time(a)),n<86400&&(i=this.sec_to_time(n)),this.$router.push({name:"historicalPlayback",query:{imei:e.iMei,type:"gun",year:e.preTime.split(" ")[0],start:t,end:i}})},formatDateTime:function(e){return e?Object(m["d"])(e,1):e},secondsFormat:function(e){var t=Math.floor(e/86400),i=Math.floor((e-24*t*3600)/3600),a=Math.floor((e-24*t*3600-3600*i)/60),n=e-24*t*3600-3600*i-60*a;return t+"天"+i+"时"+a+"分"+n+"秒"},excute:function(){var e=this,t=this;t.$refs.ruleForm.validate(function(i){if(i){if(!e.ruleForm.value1)return void e.$message.warning("请选择日期");d({tableName:e.ruleForm.value1}).then(function(t){0==t.status?e.$message.success(t.msg):e.$message.error(t.msg)}).finally(function(){t.listLoading=!1})}})},getList:function(){var e=this,t=this;t.listLoading=!0,s({page:this.listQuery.page,limit:this.listQuery.limit}).then(function(i){0==i.status?(e.listLoading=!1,e.list=i.data,0==i.data.length&&e.$message.success("无数据"),e.total=i.count,e.indexMethod=(t.listQuery.page-1)*t.listQuery.limit+1):e.$message.error(i.msg)}).finally(function(){t.listLoading=!1})},handleFilter:function(e){var t=this;"pagination"!==e&&(this.listQuery.page=1),this.listLoading=!0,void 0!=this.listQuery.iMei&&null!=this.listQuery.iMei||(this.listQuery.iMei=""),this.value1||(this.value1=[]),c({keyword:this.listQuery.iMei,tableName:this.dealDate(),page:this.listQuery.page,limit:this.listQuery.limit}).then(function(e){0==e.status?(t.total=0,t.listLoading=!1,null==e.data||0==e.data.length?(t.list=[],t.$message.success("无数据")):t.list=e.data,t.total=e.count,t.indexMethod=(t.listQuery.page-1)*t.listQuery.limit+1):t.$message.error(e.msg)})},handleDelete:function(e){var t=this,i=this;i.listLoading=!0,u({id:e.id}).then(function(e){0==e.status?(i.listQuery.page>1&&i.list.length<=1&&(i.listQuery.page-=1),t.handleFilter(),i.$message.success("刪除成功"),t.$store.commit("realTimeMonitor/ISEDITFILES",!0)):(t.$message.error(e.msg),i.listLoading=!1)}).catch(function(e){i.listLoading=!1,console.error(e)})},tableRowClassName:function(e){e.row;var t=e.rowIndex;return t%2==0?"color-row":t%2==1?"noColor-row":""},exportExcel:function(){var e=this.dealDate();Object(p["b"])({dates:e,excelType:10,title:"枪支异常信息"}).then(function(t){t.headers;var i="";e.length>1&&(i=e[e.length-1]);var a="";a=0==e.length?"枪支异常信息.xls":e[0]+"----"+i+"枪支异常信息.xls";var n=new Blob([t],{type:"application/excel"}),r=document.createElement("a");r.href=window.URL.createObjectURL(n),r.download=a,r.click(),r.remove()})}}},g=f,h=(i("f324"),i("2877")),v=Object(h["a"])(g,a,n,!1,null,null,null);t["default"]=v.exports},d2d5:function(e,t,i){i("1654"),i("549b"),e.exports=i("584a").Array.from},d4f5:function(e,t,i){"use strict";var a=i("4b78"),n=i.n(a);n.a},df7c:function(e,t,i){(function(e){function i(e,t){for(var i=0,a=e.length-1;a>=0;a--){var n=e[a];"."===n?e.splice(a,1):".."===n?(e.splice(a,1),i++):i&&(e.splice(a,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}var a=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,n=function(e){return a.exec(e).slice(1)};function r(e,t){if(e.filter)return e.filter(t);for(var i=[],a=0;a<e.length;a++)t(e[a],a,e)&&i.push(e[a]);return i}t.resolve=function(){for(var t="",a=!1,n=arguments.length-1;n>=-1&&!a;n--){var l=n>=0?arguments[n]:e.cwd();if("string"!==typeof l)throw new TypeError("Arguments to path.resolve must be strings");l&&(t=l+"/"+t,a="/"===l.charAt(0))}return t=i(r(t.split("/"),function(e){return!!e}),!a).join("/"),(a?"/":"")+t||"."},t.normalize=function(e){var a=t.isAbsolute(e),n="/"===l(e,-1);return e=i(r(e.split("/"),function(e){return!!e}),!a).join("/"),e||a||(e="."),e&&n&&(e+="/"),(a?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,i){function a(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var i=e.length-1;i>=0;i--)if(""!==e[i])break;return t>i?[]:e.slice(t,i-t+1)}e=t.resolve(e).substr(1),i=t.resolve(i).substr(1);for(var n=a(e.split("/")),r=a(i.split("/")),l=Math.min(n.length,r.length),o=l,s=0;s<l;s++)if(n[s]!==r[s]){o=s;break}var u=[];for(s=o;s<n.length;s++)u.push("..");return u=u.concat(r.slice(o)),u.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=n(e),i=t[0],a=t[1];return i||a?(a&&(a=a.substr(0,a.length-1)),i+a):"."},t.basename=function(e,t){var i=n(e)[2];return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i},t.extname=function(e){return n(e)[3]};var l="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)}}).call(this,i("f28c"))},e052:function(e,t,i){},e419:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container",attrs:{id:"oilRecord"}},[i("div",{staticClass:"filter-container"},[i("el-date-picker",{staticClass:"filter-item",attrs:{type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}}),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),i("el-button",{staticClass:"filter-item",staticStyle:{width:"165px"},attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("添加加油记录")]),i("el-button",{attrs:{type:"primary",icon:"iconfont icondaochu"},on:{click:function(t){return e.exportExcel(0)}}},[e._v("导出")]),i("el-button",{attrs:{type:"primary",icon:"iconfont icondaochu"},on:{click:function(t){return e.exportExcel(1)}}},[e._v("导出所有")]),i("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:function(t){return e.goBack()}}},[e._v("返回")])],1),i("div",{staticClass:"tableBox"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,fit:"","highlight-current-row":"","row-class-name":e.tableRowClassName,layout:"prev, pager, next, sizes, total, jumper"}},[i("el-table-column",{attrs:{label:"序号",fixed:"",prop:"id",sortable:"custom",align:"center",width:"80",type:"index",index:e.indexMethod}}),i("el-table-column",{attrs:{label:"id",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.id))])]}}])}),i("el-table-column",{attrs:{label:"油卡号",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[1==e.power?i("span",{staticClass:"link-type",on:{click:function(t){return e.handleUpdate(a)}}},[e._v(e._s(a.fuelcardNo))]):i("span",[e._v(e._s(a.fuelcardNo))])]}}])}),i("el-table-column",{attrs:{label:"车牌号",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.licenseNo))])]}}])}),i("el-table-column",{attrs:{label:"加油量(L)",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.refuel))])]}}])}),i("el-table-column",{attrs:{label:"加油金额(元)",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.price))])]}}])}),i("el-table-column",{attrs:{label:"加油时间",minWidth:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.formatDateTime(a.refuelTime)))])]}}])}),i("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"300","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit-outline"},on:{click:function(t){return e.handleUpdate(a)}}},[e._v("编辑")]),i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]}}])})],1)],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}}),i("el-dialog",{attrs:{id:"myDialog",title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.temp,"label-position":"left"}},[i("el-form-item",{attrs:{label:"加油量",prop:"refuel"}},[i("el-input",{attrs:{placeholder:"单位:(L)"},model:{value:e.temp.refuel,callback:function(t){e.$set(e.temp,"refuel",t)},expression:"temp.refuel"}})],1),i("el-form-item",{attrs:{label:"加油金额",prop:"price"}},[i("el-input",{attrs:{placeholder:"单位:(元)"},model:{value:e.temp.price,callback:function(t){e.$set(e.temp,"price",t)},expression:"temp.price"}})],1),"create"===e.dialogStatus?i("el-form-item",{attrs:{label:"加油时间",prop:"time"}},[i("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.temp.time,callback:function(t){e.$set(e.temp,"time",t)},expression:"temp.time"}})],1):e._e()],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v("确定")])],1)],1)],1)},n=[],r=(i("34ef"),i("c5f6"),i("78ce"),i("333d")),l=i("54f9"),o=i("69d9"),s=i("66e8"),u=void 0,c={name:"oilRecord",components:{Pagination:r["a"]},data:function(){return{power:JSON.parse(sessionStorage.getItem("userInfo")).Power,tableKey:0,list:null,total:0,indexMethod:1,listLoading:!1,listQuery:{page:1,limit:10,iMei:void 0},temp:{id:void 0,refuel:void 0,price:void 0,time:void 0},fuelcardNo:this.$route.params.fuelcardNo,licenseNo:this.$route.params.licenseNo,startTime:null,endTime:null,dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"添加"},rules:{fuelcardNo:[{required:!0,message:"请填写油卡号",trigger:"blur"}],refuel:[{required:!0,message:"请填写加油量",trigger:"blur"}],price:[{required:!0,message:"请填写加油金额",trigger:"blur"}],time:[{required:!0,message:"请选择加油时间",trigger:"blur"}]},pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-7776e6),e.$emit("pick",[i,t])}}]},timeRange:[(new Date).setTime((new Date).getTime()-6048e5),new Date]}},created:function(){this.startTime=new Date(this.timeRange[0]).getTime(),this.endTime=new Date(this.timeRange[1]).getTime(),this.getList()},methods:{formatDateTime:function(e){return Object(o["d"])(e,1)},reset:function(){this.timeRange=[(new Date).setTime((new Date).getTime()-6048e5),new Date],this.startTime=new Date(this.timeRange[0]).getTime(),this.endTime=new Date(this.timeRange[1]).getTime()},getList:function(){var e=this,t=this;t.listLoading=!0,Object(l["j"])({startTime:this.startTime,endTime:this.endTime,fuelcardNo:this.fuelcardNo,licenseNo:this.licenseNo,page:this.listQuery.page,limit:this.listQuery.limit}).then(function(i){0==i.status?(e.listLoading=!1,null==i.data?e.list=[]:e.list=i.data,e.total=i.count,e.indexMethod=(t.listQuery.page-1)*t.listQuery.limit+1):e.$message.error(i.msg)}).finally(function(){t.listLoading=!1})},handleFilter:function(){this.listQuery.page=1,this.getList()},resetTemp:function(){this.temp={id:void 0,refuel:void 0,price:void 0,time:void 0}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs["dataForm"].clearValidate()})},createData:function(){var e=this;this.$refs["dataForm"].validate(function(t){if(!t)return!1;u=e.$loading({target:"#myDialog .el-dialog"}),Object(l["a"])({fuelcardNo:e.fuelcardNo,refuel:Number(e.temp.refuel),price:Number(e.temp.price),time:e.temp.time.getTime()}).then(function(t){0==t.status?(e.reset(),e.getList(),e.$message.success("添加成功"),e.dialogFormVisible=!1):e.$message.error(t.msg)}).finally(function(){u.close()})})},handleUpdate:function(e){var t=this;this.temp=Object.assign({},e),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},updateData:function(){var e=this;this.$refs["dataForm"].validate(function(t){if(!t)return!1;u=e.$loading({target:"#myDialog .el-dialog"}),Object(l["l"])({id:e.temp.id,refuel:e.temp.refuel,price:e.temp.price}).then(function(t){0==t.status?(e.reset(),e.getList(),e.$message.success("编辑成功"),e.dialogFormVisible=!1):e.$message.error(t.msg)}).finally(function(){u.close()})})},handleDelete:function(e){var t=this,i=this;i.listLoading=!0,Object(l["b"])({id:e.id}).then(function(e){0==e.status?(i.listQuery.page>1&&i.list.length<=1&&(i.listQuery.page-=1),t.reset(),t.getList(),i.$message.success("刪除成功")):(t.$message.error(e.msg),i.listLoading=!1)}).catch(function(e){i.listLoading=!1})},goBack:function(){window.history.back(-1)},tableRowClassName:function(e){e.row;var t=e.rowIndex;return t%2==0?"color-row":t%2==1?"noColor-row":""},exportExcel:function(e){var t=this,i=[];this.timeRange&&this.timeRange.length&&(i[0]=new Date(this.timeRange[0]).getTime(),i[1]=new Date(this.timeRange[1]).getTime());var a="";a=1==e?"":this.licenseNo,Object(s["b"])({dates:i,excelType:13,title:"加油记录",licenseNo:a}).then(function(e){try{var n=new TextDecoder("utf-8"),r=JSON.parse(n.decode(new Uint8Array(e)));t.$message({message:r.msg,type:"warning"})}catch(c){e.headers;var l="";a&&(l=a+"----"),0==i.length?l+="加油记录.xls":l+=Object(o["d"])(t.timeRange[0],1)+"----"+Object(o["d"])(t.timeRange[1],1)+" 加油记录.xls";var s=new Blob([e],{type:"application/excel"}),u=document.createElement("a");u.href=window.URL.createObjectURL(s),u.download=l,u.click(),u.remove()}})}}},d=c,m=(i("6fa7"),i("2877")),p=Object(m["a"])(d,a,n,!1,null,null,null);t["default"]=p.exports},f324:function(e,t,i){"use strict";var a=i("5e2b"),n=i.n(a);n.a},f410:function(e,t,i){i("1af6"),e.exports=i("584a").Array.isArray}}]);
//# sourceMappingURL=oilStatistics.8d656baa.js.map